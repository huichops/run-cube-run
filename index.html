<!DOCTYPE html>
<html>
<head>
	<style>
		body {
			font-family: Monospace;
			background-color: #eee;
			margin: 0px;
			overflow: hidden;
		}
	</style>

</head>
<body>
	<script src="three.min.js"></script>
	<script src="requestAnimationFrame.js"></script>
	<script src="Keys.js"></script>
	<script src="Tile.js"></script>
	<script src="Spike.js"></script>
	<script src="Player.js"></script>
	<script type="text/javascript">
		
		
			// Global variables
			var keys = new Keys();
			window.onkeydown = function(e){
				keys.onKeyDown(e);
			}
			window.onkeyup = function(e){
				keys.onKeyUp(e);
			}
			var tempRot = 0.05;
			var cubeRotation = 90;
			var toggle = true;
			// Scene variables
			var scene = new THREE.Scene();
			var camera = new THREE.CombinedCamera( window.innerWidth / 2, window.innerHeight / 2, 70, 1, 1000, - 500, 1000 );
			//var cameraOrtho = new THREE.OrthographicCamera(0,window.innerWidth,0,window.innerHeigt, 1, 2000);
			camera.position.z = 300;
			camera.position.y = 100;
			camera.lookAt(scene.position);
			var renderer = new THREE.WebGLRenderer();
			renderer.setSize(window.innerWidth, window.innerHeight);
			document.body.appendChild(renderer.domElement);

			var geometry = new THREE.CubeGeometry(30,30,30,1,1,1);
			var material = new THREE.MeshLambertMaterial({color: 0x555555});
			var wireFrame = new THREE.MeshBasicMaterial({color: 0xffffff, 
														wireframe: true,
														wireframeLinewidth: 2});
			var multiMaterial = [ material, wireFrame ];

										
			var piso = new THREE.SceneUtils.createMultiMaterialObject(
					new THREE.CubeGeometry(1500,10,100,1,1,1),multiMaterial);
			piso.position.x = 0;
			scene.add(piso);

			/*cone = new THREE.CylinderGeometry(0, 20,40,50,50, false);
			var spike  = new THREE.Mesh(cone, material3);
			spike.position.y = 20;
			scene.add(spike);*/
			
			var player = new Player(scene);
			player.init();
			
			var tiles = [];
			var obstacles = [];

			var time = 250;
			function timer(){
				var tile = new Tile(scene);

				var random = Math.random();
				console.log(random);
				if( random < 0.26 ){
					console.log("<");
					time = 250;
				}
				if( random < 0.75 ){
				console.log(">");
					time = 750;
				}
				else {
					time = 1000;
				}
				tile.init(200,12,0);
				tiles.push(tile);
				obstacles.push(tile.mesh);
				window.setTimeout(timer, time);
				
			}
			window.setTimeout(timer, time);

			var render = function () {
				requestAnimFrame(render);
				player.update();
				for(var i=0; i<tiles.length; i++){
					tiles[i].update();
				}
				
				renderer.render(scene, camera);
				camera.position.x = player.mesh.position.x + 100;
			};
			function degToRad(angle){
				return deg * Math.PI / 180;
			}
			function rotateAroundScene(angle){
				angle = degToRad(angle);
			}
			
			render();

	</script>
</body>
</html>
